@using SaberesSyllabus.Repositories
@using SaberesySoluciones.Models
@model List<SaberesySoluciones.Models.Categoria>


<h1>Gestión de Aprendizajes</h1>

<button type="button" data-toggle="modal" data-target="#modalAddCat" class="btn btn-success btn-sm">
    <i class="fa fa-plus"></i> Agregar Categoría
</button>
<br/>

@foreach (Categoria catergoria in Model)
{
    <br/>
    <h3>@catergoria.Nombre
        <button type="button" data-toggle="modal" data-target="#modalEditCat" class="btn btn-warning btn-sm" style="float: right" onclick="editCat('@catergoria.Nombre')">
            <i class="fa fa-edit"></i> Modificar Categoría
        </button>
    </h3>

    <button type="button" data-toggle="modal" data-target="#modalAddSubcat" class="btn btn-success btn-sm" onclick="addSubcat('@catergoria.Nombre')">
        <i class="fa fa-plus"></i> Agregar Subcategoría
    </button>
    <br/>

    foreach (Subcategoria subcategoria in catergoria.Subcategorias)
    {
        <br />
        <h4>@catergoria.Nombre @subcategoria.Codigo - @subcategoria.Nombre
            <button type="button" data-toggle="modal" data-target="#modalEditSubcat" class="btn btn-warning btn-sm" style="float: right" onclick="editSubcat('@subcategoria.Nombre')">
                <i class="fa fa-edit"></i> Modificar Subcategoría
            </button>
        </h4>

        <button type="button" data-toggle="modal" data-target="#modalAddApren" class="btn btn-success btn-sm" onclick="addApren('@subcategoria.Nombre')">
            <i class="fa fa-plus"></i> Agregar Aprendizaje
        </button>
        <br />
        <br/>
        <!--Table Aprendizajes-->
        <table class="table table-striped table-hover table-bordered">
            <thead class="thead-dark">
            <tr>
                <th>Código</th>
                <th>Descripción</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <!--Table content-->
            @foreach (Aprendizaje apren in subcategoria.Aprendizajes)
            {

                <tr>
                    <td>@apren.Codigo</td>
                    <td style="text-align: justify">@apren.Descripcion</td>
                    <td style="vertical-align: middle; white-space: nowrap; text-align: right">
                        <button id="btn-edit" type="button" data-toggle="modal" data-target="#modalEditApren" class="btn btn-warning btn-sm"
                                onclick="editApren('@apren.Codigo', '@apren.Descripcion')">
                            <i class="fa fa-edit"></i> Modificar
                        </button>
                        @if (@apren.Estado.ToString() == "Habilitado")
                        {
                            <button id="btn-disable" type="button" data-toggle="modal" data-target="#modalDisableApren" class="btn btn-danger btn-sm"
                                    onclick="disable('@apren.Codigo')">
                                <i class="fa fa-eye-slash"></i> Deshabilitar
                            </button>


                        }
                        @if (@apren.Estado.ToString() == "Deshabilitado")
                        {
                            <button id="btn-disable" type="button" data-toggle="modal" data-target="#modalEnableApren" class="btn btn-primary btn-sm"
                                    onclick="enable('@apren.Codigo')">
                                <i class="fa fa-eye"></i> Habilitar
                            </button>
                        }
                    </td>

                </tr>
            }
            </tbody>
        </table>
    }
}




<!--Scripts-->
<script type="text/javascript">
    
    editCat = function (cat) {
        document.getElementById("categoriaprev").setAttribute("value", cat);
    }

    editSubcat = function (subcat) {
        document.getElementById("subcategoriaprev").setAttribute("value", subcat);
    }

    addSubcat = function (cat) {
        document.getElementById("categoria").setAttribute("value", cat);
    }

    addApren = function (subcat) {
        document.getElementById("subcategoria").setAttribute("value", subcat);
    }
</script>

<!--Modals-->
@Html.Partial("_AddAprendizaje")

@Html.Partial("_EditAprendizaje")

@Html.Partial("_EnableAprendizaje")

@Html.Partial("_DisableAprendizaje")

@Html.Partial("_AddCategoria")

@Html.Partial("_EditCategoria")

@Html.Partial("_AddSubcategoria")

@Html.Partial("_EditSubcategoria")